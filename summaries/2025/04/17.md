# Activity Summary for 17/04/2025

## 11:44:14
The `/Users/dennisabonda/Desktop/projects/hitachi-gts-mcs-api/src/services/payroll_process.service.js` file, last updated on 17/04/2025 at 10:44:14, contains a comprehensive set of asynchronous functions related to payroll processing.  These functions interact with various MongoDB models (`PayrollProcess`, `Requests`, `User`, `Configuration`, `PayrollConfig`, `Companies`, `Notification`, `NotificationLogsModel`, `FixedSalaryLogModel`, `Recursive`, `Payslips`, `Payitems`, `EOSModel`, `SalaryAdjustment`, `OffCyclePayitems`, `CoreConfig`, `MonthlyWisePayitem`, and `PayrollModel`) to retrieve, process, and aggregate payroll data.

Key functionalities include: retrieving payroll processes (getAllPayrollProcess, getPayrollProcess, getPayrollProcessByCompanyIdKeysService, getPayrollProcessByFilterKeys, etc.),  filtering by company ID and status (getPayrollProcessActiveByCompanyIdService, getPayrollProcessActiveByConfigIdService, getPayrollProcessByCompanyIdStatStatus),  handling salary adjustments (payMonthSalaryAdjustment), retrieving user data using aggregation (getUserByAggregate, getUserIdByAggregateActive),  getting configuration data (getConfiguration), calculating payroll statistics (getCardsValue), computing variance between payroll periods (getPayrollProcessComputeVariance), and generating gratuity reports (getPayrollProcessComputeGratuity).

The code utilizes various libraries, including `mongoose`, `moment`, `lodash`, `crypto-js`, and an AWS SDK for SES email services.  The functions extensively use aggregate queries for efficient data retrieval and processing.  There's a significant reliance on `company_id` and `pay_month` for filtering and querying payroll data across multiple models, suggesting a structured approach to managing payroll information by company and pay period.  The `getPayrollProcessComputeGratuity` function demonstrates complex logic for gratuity calculations, including fetching and processing data from `PayrollConfig`, `User` and `CoreConfig` models.  The function also uses `moment.js` for date manipulation and includes checks for handling different cases based on the value of `selectedCompanyID`.
